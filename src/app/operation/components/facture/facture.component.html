<div class="mt-3 pt-3">
  <div class="m-auto w-100 p-5 border h-100">
    <div class="card-body">
      <h4 class="mb-3 border-bottom border-1 pb-3 my-2">
        Paiement des factures
      </h4>
      <!-- <div class="card">
        <div class="row bg-white mx-2 py-4">
          <div class="col-md-2">
            <img
              [src]="creancier?.agency?.image"
              class="mx-auto d-block img-fluid"
              alt=""
            />
          </div>
          <div class="col-md-3">
            <h4>Créancier</h4>
            <h6>{{ creancier?.name }}</h6>
          </div>
          <div class="col-md-7">
            <h4>Débiteur</h4>
            <h6>{{ currentUser?.fullName }}</h6>
          </div>
        </div>
      </div> -->
      <div class="card mb-3" >
        <div class="row g-0 py-4 mx-2">
          <div class="col-md-4 d-flex justify-content-center align-items-center">
            <img
              [src]="creancier?.agency?.image"
              class="mx-auto d-block img-fluid"
              alt="..."
            />
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h3 class="card-title">{{ creancier?.name }}</h3>
              <ul class="card-text">
                <li>Debiteur: {{ currentUser?.fullName }}</li>
                <li>telephone: {{ currentUser?.phoneNumber }}</li>
                <li>email: {{ currentUser?.email }}</li>
                <li>agence: {{ creancier?.agency?.name }}</li>
              </ul>
              <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
            </div>
          </div>
        </div>
      </div>
      <div class="card mt-2">
        <div class="card-header">Vos Factures non payées</div>
        <div class="card-body">
          <h3 class="card-title">Selectionner pour payer</h3>
          <p class="card-text"></p>

          <div class="overflow-scroll">
            <app-multi-select-table
              [data]="unpaidOperations"
              [displayedColumns]="[
                { name: 'id', value: ['id'] },
                { name: 'amount', value: ['amount'] },
                { name: 'status', value: ['operationStatus'] },
                { name: 'créancier', value: ['service', 'name'] },
                { name: 'type', value: ['service', 'type'] },
                { name: 'username', value: ['clientUsername'] },
                { name: 'email', value: ['clientEmail'] }
              ]"
            />
          </div>

          <div class="m-auto" *ngIf="unpaidOperations.length == 0">
            <hr />
            <span>Vous avez aucunes facture a payer</span>
            <hr />
          </div>
        </div>
        <div class="m-2 d-flex justify-content-end">
          <button
            type="button"
            class="btn btn-success text-capitalize"
            (click)="showOtpModal()"
            style="background-color: #60bd7a"
          >
            Pay Now
          </button>
        </div>
      </div>

      <!--
        <div class="form-group d-flex justify-content-end mt-3">
          <button
            [disabled]="loading"
            class="btn btn-primary ms-2"
            (click)="openDialog(content)"
          >
            <span
              *ngIf="loading"
              class="spinner-border spinner-border-sm mr-1"
            ></span>
            Suivant
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <ng-template #content let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Récapitulation</h4>
      <button
        type="button"
        class="btn-close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      ></button>
    </div>
    <div class="modal-body">
      <table class="table table-hover">
        <tbody>
          <tr>
            <td class="title">Débiteur :</td>
            <td>{{ nom }}</td>
          </tr>
          <tr>
            <td class="title">Montant :</td>
            <td>{{ total }}</td>
          </tr>
          <tr>
            <td class="title">Bénéficiaire :</td>
            <td>{{ provider?.name }}</td>
          </tr>
          <tr>
            <td class="title">Date :</td>
            <td>{{ date }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-outline-dark"
        (click)="modal.close('Save click')"
      >
        Annuler
      </button>
      <button
        type="button"
        class="btn btn-outline-dark"
        (click)="openOTPDialog(otp)"
      >
        Valider
      </button>
    </div>
  </ng-template>
  
  <ng-template #otp let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Code de confirmation</h4>
      <button
        type="button"
        class="btn-close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      ></button>
    </div>
    <div class="modal-body">
      <form [formGroup]="otpForm" class="bg-white p-3">
        <div class="row">
          <div class="col-md-12">
            <div class="">
              <input
                type="text"
                name="otp"
                formControlName="otp"
                class="form-control"
                placeholder="Code de confirmation.."
                [ngClass]="{
                  'is-invalid': submitted1 && (otpError || o['otp'].errors)
                }"
              />
              <div
                *ngIf="submitted1 && (otpError || o['otp'].errors)"
                class="invalid-feedback"
              >
                <div *ngIf="submitted1 && (otpError || o['otp'].errors)">
                  Code invalide
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-outline-dark"
        (click)="modal.close('Save click')"
      >
        Annuler
      </button>
      <button type="button" class="btn btn-outline-dark" (click)="verifyOTP()">
        Valider
      </button>
    </div>
  </ng-template>
   -->
      <!-- </div>
    </div>
  </div>
</div> -->
    </div>
  </div>
</div>
